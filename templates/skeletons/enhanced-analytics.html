<!-- templates/skeletons/enhanced-analytics.html -->
<!-- Based on display_enhanced_analytics_template.php -->
<!-- CSS classes and structure match the PHP template. -->
<!-- JS for charts MUST be handled separately in WordPress via wp_enqueue_script. -->
<!-- Placeholders {{VARIABLE_NAME}} will be replaced by Gemini. -->

<div class="enhanced-analytics-container">
  <div class="section-header">
    <h2 class="section-title">{{TITLE}}</h2>
  </div>
  
  <div class="analytics-section radar-chart-section" {{SHOW_RADAR ? '' : 'style="display:none;"'}}>
    <div class="section-header">
      <h3>Item Metrics Analysis</h3>
      <p class="section-description">Multi-dimensional analysis of key value factors</p>
    </div>
    <div class="chart-card">
      <div class="chart-card-header"><h4>Value Metrics Radar</h4></div>
      <div class="chart-content">
        <div class="radar-wrapper" data-chart-data-radar="{{RADAR_CHART_DATA_JSON}}">
          <canvas id="{{CHART_ID_RADAR}}" width="400" height="400"></canvas> <!-- JS Target -->
        </div>
        <div class="radar-metrics-legend">
          <div class="legend-item"><span class="legend-color" style="background-color: rgba(54, 162, 235, 0.6);"></span><span class="legend-label">Item Metrics</span></div>
        </div>
      </div>
    </div>
    <div class="metrics-grid">
      <div class="metric-card"><div class="metric-header"><h4>Condition</h4></div><div class="metric-value">{{CONDITION_SCORE}}%</div><div class="metric-footer"><div class="metric-description">Physical state assessment</div></div></div>
      <div class="metric-card"><div class="metric-header"><h4>Rarity</h4></div><div class="metric-value">{{RARITY_SCORE}}%</div><div class="metric-footer"><div class="metric-description">Availability in the market</div></div></div>
      <div class="metric-card"><div class="metric-header"><h4>Market Demand</h4></div><div class="metric-value">{{MARKET_DEMAND_SCORE}}%</div><div class="metric-footer"><div class="metric-description">Current collector interest</div></div></div>
      <div class="metric-card"><div class="metric-header"><h4>Historical Significance</h4></div><div class="metric-value">{{HISTORICAL_SIGNIFICANCE}}%</div><div class="metric-footer"><div class="metric-description">Cultural and historical impact</div></div></div>
      <div class="metric-card"><div class="metric-header"><h4>Investment Potential</h4></div><div class="metric-value">{{INVESTMENT_POTENTIAL}}%</div><div class="metric-footer"><div class="metric-description">Projected value growth</div></div></div>
      <div class="metric-card"><div class="metric-header"><h4>Provenance Strength</h4></div><div class="metric-value">{{PROVENANCE_STRENGTH}}%</div><div class="metric-footer"><div class="metric-description">History of ownership quality</div></div></div>
    </div>
  </div>

  <div class="analytics-section price-history-section" {{SHOW_HISTORY ? '' : 'style="display:none;"'}}>
    <div class="section-header">
      <h3>Price History Analysis</h3>
      <p class="section-description">Historical price trends for comparable items</p>
    </div>
    <div class="chart-card">
      <div class="chart-card-header">
        <h4>Market Price History</h4>
        <div class="price-trend-badge {{TREND_CLASS}}">{{PRICE_TREND}} annual</div>
      </div>
      <div class="chart-content">
        <div class="price-chart-wrapper" data-chart-data-history="{{HISTORY_CHART_DATA_JSON}}">
          <canvas id="{{CHART_ID_PRICE}}" height="300"></canvas> <!-- JS Target -->
        </div>
        <div class="price-chart-legend">
          <div class="legend-item"><span class="legend-color" style="background-color: rgb(75, 192, 192);"></span><span class="legend-label">Comparable Items</span></div>
          <!-- Add Market Index legend item if has_indices is true -->
          <!-- {{HAS_INDICES ? '<div class="legend-item"><span class="legend-color" style="background-color: rgb(153, 102, 255);"></span><span class="legend-label">Market Index</span></div>' : ''}} -->
          <div class="legend-item"><span class="legend-color" style="background-color: rgb(255, 99, 132);"></span><span class="legend-label">Your Item</span></div>
        </div>
      </div>
    </div>
    <div class="price-highlights">
      <div class="highlight-card"><div class="highlight-header">Current Value</div><div class="highlight-value">{{VALUE_FORMATTED}}</div></div>
      <div class="highlight-card"><div class="highlight-header">5-Year Change</div><div class="highlight-value {{TREND_CLASS}}">{{PRICE_TREND}}</div></div>
      <div class="highlight-card"><div class="highlight-header">Market Prediction</div><div class="highlight-value">{{PREDICTED_VALUE_FORMATTED}} <span class="prediction-year">({{NEXT_YEAR}})</span></div></div>
    </div>
  </div>

  <div class="analytics-section statistics-section" {{SHOW_STATS ? '' : 'style="display:none;"'}}>
    <div class="section-header">
      <h3>Market Statistics Analysis</h3>
      <p class="section-description">Comprehensive statistical analysis of market data</p>
    </div>
    <div class="chart-card">
      <div class="chart-card-header"><h4>Statistical Summary</h4></div>
      <div class="chart-content"><div class="statistics-summary">
          <p>Market analysis reveals {{TOTAL_COUNT}} comparable items with an average value of {{AVG_PRICE_FORMATTED}}.</p>
          <p>Your item's value of {{VALUE_FORMATTED}} places it in the {{PERCENTILE}} percentile, with a {{PRICE_TREND}} average annual growth rate.</p>
          <p>Market confidence: <strong>{{CONFIDENCE_LEVEL}}</strong></p>
      </div></div>
    </div>
    <div class="chart-card">
      <div class="chart-card-header"><h4>Market Position Analysis</h4></div>
      <div class="chart-content">
        <div class="market-position-container">
          <div class="market-gauge-wrapper">
            <div class="gauge-container">
              <div class="gauge"><div class="gauge-fill" style="--percentage: {{PERCENTILE_NUMBER}};"></div><div class="gauge-center"></div><div class="gauge-needle" style="--rotation: {{PERCENTILE_ROTATION}}deg;"></div></div>
              <div class="gauge-labels"><span class="gauge-label low">Low</span><span class="gauge-label medium">Medium</span><span class="gauge-label high">High</span><span class="gauge-label premium">Premium</span></div>
              <div class="gauge-value">{{PERCENTILE}} Percentile</div>
              <div class="gauge-description">Your item is in the {{APPRECIATION_STATUS}} market segment</div>
            </div>
          </div>
          <div class="market-position-highlights">
            <div class="position-highlight-card"><div class="highlight-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><h5>Market Timing</h5><div class="highlight-value {{TREND_CLASS}}">{{MARKET_TIMING}}</div><p>Based on current market conditions</p></div>
            <div class="position-highlight-card"><div class="highlight-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><h5>Market Demand</h5><div class="highlight-value">{{MARKET_DEMAND_SCORE}}%</div><p>Current collector interest level</p></div>
            <div class="position-highlight-card"><div class="highlight-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M20.59 13.41L13.42 20.58C13.2343 20.766 13.0137 20.9135 12.7709 21.0141C12.5281 21.1148 12.2678 21.1666 12.005 21.1666C11.7422 21.1666 11.4819 21.1148 11.2391 21.0141C10.9963 20.9135 10.7757 20.766 10.59 20.58L2 12V2H12L20.59 10.59C20.9625 10.9647 21.1716 11.4716 21.1716 12C21.1716 12.5284 20.9625 13.0353 20.59 13.41Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M7 7H7.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><h5>Rarity Impact</h5><div class="highlight-value">{{RARITY_SCORE}}%</div><p>Effect of item scarcity on value</p></div>
          </div>
        </div>
      </div>
    </div>

    <div class="section-header item-metrics-header">
      <h3>Item Metrics Analysis</h3> <!-- Re-using header, maybe change text? -->
      <p class="section-description">Multi-dimensional analysis of key value factors</p>
    </div>

    <div class="market-analysis-grid">
      <div class="chart-card distribution-card">
        <div class="chart-card-header"><h4>Price Distribution</h4></div>
        <div class="chart-content">
          <div class="modern-chart-container" data-histogram-data="{{HISTOGRAM_DATA_JSON}}">
            <div class="modern-chart-bars">{{HISTOGRAM_BARS_HTML}}</div>
            <div class="chart-axis">{{HISTOGRAM_AXIS_HTML}}</div>
            <div class="your-value-marker" style="left: calc({{TARGET_POSITION}}% - 1px);"><div class="marker-line"></div><div class="marker-label">{{VALUE_FORMATTED}}</div></div>
          </div>
        </div>
      </div>

      <div class="metrics-grid stats-metrics-grid">
        <div class="metric-card shadcn-card">
          <div class="metric-header"><h4>Market Averages</h4><span class="trend-badge {{TREND_CLASS}}">{{PRICE_TREND}} annual</span></div>
          <div class="metric-values"><div class="metric-value-row"><span class="metric-label">Mean</span><span class="metric-value">{{AVG_PRICE_FORMATTED}}</span></div><div class="metric-value-row"><span class="metric-label">Median</span><span class="metric-value">{{MEDIAN_PRICE_FORMATTED}}</span></div></div>
          <div class="metric-footer"><div class="metric-description">Based on {{COUNT}} comparable items</div></div>
        </div>
        <div class="metric-card shadcn-card">
           <div class="metric-header"><h4>Price Range & Variation</h4></div>
           <div class="price-range-display"><div class="price-range-value">{{PRICE_MIN_FORMATTED}} - {{PRICE_MAX_FORMATTED}}</div><div class="price-range-bar" data-target-position="{{TARGET_POSITION}}"></div></div>
           <div class="metric-footer"><div class="badge">CV: {{COEFFICIENT_VARIATION}}%</div><div class="badge secondary">SD: {{STD_DEV_FORMATTED}}</div></div>
         </div>
         <div class="metric-card shadcn-card highlighted">
            <div class="metric-header"><h4>Investment Potential</h4></div>
            <div class="investment-rating-display"><div class="investment-rating"><span class="rating-value">{{INVESTMENT_POTENTIAL}}%</span><span class="rating-label">Potential</span></div><div class="investment-scale"><div class="scale-bar" style="--fill-width: {{INVESTMENT_POTENTIAL}}%"></div></div></div>
            <div class="metric-footer"><div class="metric-description">Based on market trends and item characteristics</div></div>
         </div>
         <div class="metric-card shadcn-card">
           <div class="metric-header"><h4>Market Confidence</h4></div>
           <div class="confidence-display" data-confidence-level="{{CONFIDENCE_LEVEL_NUMERIC}}">
             <div class="confidence-indicator {{CONFIDENCE_LEVEL_CLASS}}">{{CONFIDENCE_DOTS_HTML}}</div><div class="confidence-value">{{CONFIDENCE_LEVEL}}</div>
           </div>
           <div class="metric-footer"><div class="metric-description">Based on sample size and data consistency</div></div>
         </div>
      </div>
      
      <div class="chart-card advanced-data-table-card" data-sales-data="{{SALES_DATA_JSON}}">
        <div class="chart-card-header"><h4>Comprehensive Market Data</h4><div class="data-table-controls"><div class="search-filter"><input type="text" id="searchResults" placeholder="Search items..." class="search-input"></div><div class="filter-controls"><button class="filter-btn active" data-filter="all">All Results</button></div></div></div>
        <div class="sales-table-container">
          <table class="sales-table advanced-table">
            <thead><tr><th class="sortable" data-sort="title">Item <span class="sort-icon">↕</span></th><th class="sortable" data-sort="house">Auction House <span class="sort-icon">↕</span></th><th class="sortable" data-sort="date">Date <span class="sort-icon">↕</span></th><th class="sortable" data-sort="price">Price <span class="sort-icon">↕</span></th><th class="sortable" data-sort="diff">Difference <span class="sort-icon">↕</span></th></tr></thead>
            <tbody>{{SALES_TABLE_ROWS_HTML}}</tbody>
          </table>
        </div>
        <div class="table-footer"><div class="table-pagination"><button class="pagination-btn">Previous</button><span class="pagination-info">Showing 1-5 of {{COUNT}}</span><button class="pagination-btn">Next</button></div></div>
      </div>
    </div>
  </div>
</div> 