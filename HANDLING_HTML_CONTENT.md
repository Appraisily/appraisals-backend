# Handling HTML Content in WordPress Metadata

## Problem

When storing HTML content in WordPress metadata fields (like `statistics` or `justification_html`), the HTML code might not display properly when using standard WordPress shortcodes like `[get_custom_field]` because WordPress escapes HTML by default for security reasons.

## Solution

We've created a special shortcode called `display_html_content` that explicitly displays HTML content without escaping it. This should be used for fields that are expected to contain HTML markup, such as:

1. `statistics` - Contains market research information with tables and charts
2. `justification_html` - Contains auction insights with formatted tables
3. `statistics_summary` - Contains a summary of market statistics

## Implementation

### 1. New Shortcode Definition

The shortcode is defined in `services/wordpress/shortcodes.js` and also available as a standalone PHP file `display_html_content_shortcode.php` that can be added to the WordPress theme's functions.php.

```php
function display_html_content_shortcode($atts) {
  $atts = shortcode_atts(array(
    'field_name' => '',
    'default' => ''
  ), $atts);
  
  $field_name = $atts['field_name'];
  $default = $atts['default'];
  
  if (empty($field_name)) {
    return $default;
  }
  
  $value = get_field($field_name);
  if (empty($value)) {
    return $default;
  }
  
  // Return HTML content unescaped
  return $value;
}
add_shortcode('display_html_content', 'display_html_content_shortcode');
```

### 2. Usage

In WordPress templates and post content, use:

```
[display_html_content field_name="statistics" default="Default text if empty"]
```

Instead of the standard:

```
[get_custom_field field_name="statistics"]
```

### 3. Templates Updated

- `FULL_TEMPLATE.html`: Updated to use `display_html_content` for HTML fields
- `APPRAISAL_SUMMARY_PANEL.html`: Updated to use `display_html_content` for statistics_summary

### 4. Security Considerations

When using this shortcode, be aware that it intentionally does not escape HTML. This is necessary for displaying formatted content but should only be used for trusted content that is generated by our own backend systems, not for user-submitted content.

### 5. WordPress Integration

To enable this functionality in WordPress:

1. Add the `display_html_content_shortcode.php` code to your WordPress theme's `functions.php` file, or
2. Create a custom plugin with this shortcode

## Testing

After implementation, verify that HTML content in the following fields displays correctly:

- Market Research section with `statistics` field 
- Auction Market Insights section with `justification_html` field
- Market Analysis tab in the summary panel with `statistics_summary` field